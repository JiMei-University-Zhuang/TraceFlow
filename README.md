# TraceFlow

TraceFlow æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„å…¨é“¾è·¯åŸ‹ç‚¹ç›‘æ§å¹³å°ï¼Œå¸®åŠ©å¼€å‘å›¢é˜Ÿè½»æ¾å®ç°å‰ç«¯ç›‘æ§ã€æ€§èƒ½åˆ†æå’Œç”¨æˆ·è¡Œä¸ºè¿½è¸ªã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸš€ **è‡ªåŠ¨åŒ–åŸ‹ç‚¹**ï¼šæ”¯æŒè‡ªåŠ¨é‡‡é›†é¡µé¢è®¿é—®ã€ç‚¹å‡»äº‹ä»¶ã€æ€§èƒ½æŒ‡æ ‡ç­‰æ•°æ®
- ğŸ“Š **å®æ—¶ç›‘æ§**ï¼šæä¾›å®æ—¶æ•°æ®ç›‘æ§å’Œåˆ†æé¢æ¿
- ğŸ” **æ€§èƒ½åˆ†æ**ï¼šåŒ…å«é¡µé¢åŠ è½½æ€§èƒ½ã€èµ„æºåŠ è½½æ€§èƒ½ã€API è¯·æ±‚æ€§èƒ½ç­‰å¤šç»´åº¦åˆ†æ
- ğŸ¯ **ç”¨æˆ·è¡Œä¸º**ï¼šæ”¯æŒç”¨æˆ·è¡Œä¸ºè·¯å¾„åˆ†æã€çƒ­å›¾åˆ†æç­‰
- ğŸ”” **å¼‚å¸¸ç›‘æ§**ï¼šè‡ªåŠ¨æ•è·å¹¶æŠ¥å‘Š JS é”™è¯¯ã€API å¼‚å¸¸ç­‰é—®é¢˜
- ğŸ§© **æ’ä»¶ç³»ç»Ÿ**ï¼šé«˜åº¦å¯æ‰©å±•çš„æ’ä»¶æ¶æ„ï¼Œæ”¯æŒè‡ªå®šä¹‰æ•°æ®é‡‡é›†å’Œå¤„ç†é€»è¾‘
- ğŸ”’ **æ²™ç®±éš”ç¦»**ï¼šæä¾›å®‰å…¨çš„ä»£ç æ‰§è¡Œç¯å¢ƒï¼Œé˜²æ­¢æ’ä»¶é—´ç›¸äº’å¹²æ‰°

## æŠ€æœ¯æ ˆ

- **å‰ç«¯**ï¼šReact + TypeScript + Vite
- **åç«¯**ï¼šNode.js + NestJS + TypeScript
- **æ•°æ®åº“**ï¼šMongoDB
- **æ¶ˆæ¯é˜Ÿåˆ—**ï¼šRedis

## ç³»ç»Ÿæ¶æ„

TraceFlow é‡‡ç”¨æ¨¡å—åŒ–çš„å¾®æœåŠ¡æ¶æ„è®¾è®¡ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹ç»„ä»¶ï¼š

```
â”œâ”€â”€ SDK (å®¢æˆ·ç«¯åŸ‹ç‚¹)
â”‚   â”œâ”€â”€ æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ æ’ä»¶ç³»ç»Ÿ
â”‚   â”œâ”€â”€ æ²™ç®±éš”ç¦»
â”‚   â””â”€â”€ è°ƒåº¦ç³»ç»Ÿ
â”‚
â”œâ”€â”€ æ•°æ®é‡‡é›†æœåŠ¡
â”‚   â”œâ”€â”€ å®æ—¶æ•°æ®æ¥æ”¶
â”‚   â”œâ”€â”€ æ•°æ®éªŒè¯
â”‚   â””â”€â”€ æ•°æ®é¢„å¤„ç†
â”‚
â”œâ”€â”€ æ•°æ®å¤„ç†æœåŠ¡
â”‚   â”œâ”€â”€ æ•°æ®èšåˆ
â”‚   â”œâ”€â”€ æŒ‡æ ‡è®¡ç®—
â”‚   â””â”€â”€ å¼‚å¸¸æ£€æµ‹
â”‚
â””â”€â”€ å¯è§†åŒ–å¹³å°
    â”œâ”€â”€ å®æ—¶ç›‘æ§
    â”œâ”€â”€ æŠ¥è¡¨åˆ†æ
    â””â”€â”€ å‘Šè­¦ç³»ç»Ÿ
```

## é¡¹ç›®ç»“æ„

```
packages/
â”œâ”€â”€ trace-sdk/        # å®¢æˆ·ç«¯åŸ‹ç‚¹SDKï¼Œæ”¯æŒå¤šå¹³å°æ¥å…¥
â”‚   â”œâ”€â”€ src/          # æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ constants/    # å¸¸é‡å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ core/         # æ ¸å¿ƒé€»è¾‘
â”‚   â”‚   â”œâ”€â”€ plugins/      # æ’ä»¶ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ sandbox/      # æ²™ç®±éš”ç¦»ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ scheduler/    # è°ƒåº¦ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ utils/        # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ index.ts      # SDKå…¥å£
â”‚   â”œâ”€â”€ dist/         # æ„å»ºè¾“å‡º
â”‚   â””â”€â”€ test/         # æµ‹è¯•æ–‡ä»¶
â”‚
â”œâ”€â”€ trace-server/     # åç«¯æœåŠ¡ï¼Œå¤„ç†æ•°æ®é‡‡é›†å’Œåˆ†æ
â”‚   â”œâ”€â”€ src/          # æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ modules/      # æœåŠ¡æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ controllers/  # æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ services/     # æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ models/       # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ utils/        # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ dist/         # æ„å»ºè¾“å‡º
â”‚   â””â”€â”€ test/         # æµ‹è¯•æ–‡ä»¶
â”‚
â””â”€â”€ trace-admin/      # å¯è§†åŒ–ç®¡ç†å¹³å°ï¼Œæ•°æ®å±•ç¤ºå’Œé…ç½®ç®¡ç†
    â”œâ”€â”€ src/          # æºä»£ç 
    â”‚   â”œâ”€â”€ components/   # UIç»„ä»¶
    â”‚   â”œâ”€â”€ pages/        # é¡µé¢
    â”‚   â”œâ”€â”€ services/     # APIæœåŠ¡
    â”‚   â”œâ”€â”€ store/        # çŠ¶æ€ç®¡ç†
    â”‚   â””â”€â”€ utils/        # å·¥å…·å‡½æ•°
    â”œâ”€â”€ public/       # é™æ€èµ„æº
    â””â”€â”€ dist/         # æ„å»ºè¾“å‡º
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 16
- pnpm >= 8
- MongoDB >= 5
- Redis >= 6

### æœ¬åœ°å¼€å‘ç¯å¢ƒ

1. **å…‹éš†ä»“åº“**

```bash
git clone https://github.com/your-org/traceflow.git
cd traceflow
```

2. **å®‰è£…ä¾èµ–**

```bash
pnpm install
```

3. **å¯åŠ¨å¼€å‘æœåŠ¡**

```bash
# å¯åŠ¨æ‰€æœ‰é¡¹ç›®
pnpm dev

# å¯åŠ¨å•ä¸ªé¡¹ç›®
pnpm --filter trace-admin dev
pnpm --filter trace-server dev
```

4. **æ„å»ºé¡¹ç›®**

```bash
# æ„å»ºæ‰€æœ‰é¡¹ç›®
pnpm build

# æ„å»ºå•ä¸ªé¡¹ç›®
pnpm --filter trace-admin build
```

### SDKæ¥å…¥ç¤ºä¾‹

```javascript
// 1. å®‰è£…SDK
// npm install @traceflow/sdk

// 2. å¼•å…¥å¹¶åˆå§‹åŒ–
import TraceSDK from '@traceflow/sdk';
import { errorTracking, performanceTracking, userBehavior } from '@traceflow/sdk/plugins';

const sdk = new TraceSDK({
  appId: 'your-app-id',
  reportUrl: 'https://your-backend/api/collect',
  plugins: [errorTracking(), performanceTracking(), userBehavior()],
});

// 3. å…¨å±€ä½¿ç”¨
window.traceSdk = sdk;

// 4. æ‰‹åŠ¨ä¸ŠæŠ¥è‡ªå®šä¹‰äº‹ä»¶
sdk.trackEvent('user_signup', {
  userId: '12345',
  method: 'email',
});
```

## æ ¸å¿ƒæ¨¡å—

### SDKå®¢æˆ·ç«¯

TraceFlow SDKæ˜¯ä¸€ä¸ªè½»é‡çº§çš„å‰ç«¯ç›‘æ§SDKï¼Œé€šè¿‡çµæ´»çš„æ’ä»¶ç³»ç»Ÿæ”¯æŒå¤šç§ç›‘æ§åœºæ™¯ï¼š

- **æ ¸å¿ƒï¼ˆCoreï¼‰**ï¼šæä¾›åŸºç¡€åŠŸèƒ½å’ŒAPI
- **æ’ä»¶ç³»ç»Ÿï¼ˆPluginsï¼‰**ï¼šå¯æ‰©å±•çš„æ’ä»¶æ¶æ„
  - é”™è¯¯ç›‘æ§æ’ä»¶
  - æ€§èƒ½ç›‘æ§æ’ä»¶
  - ç”¨æˆ·è¡Œä¸ºæ’ä»¶
  - ç½‘ç»œè¯·æ±‚æ’ä»¶
- **æ²™ç®±ç³»ç»Ÿï¼ˆSandboxï¼‰**ï¼šå®‰å…¨éš”ç¦»çš„ä»£ç æ‰§è¡Œç¯å¢ƒ
- **è°ƒåº¦ç³»ç»Ÿï¼ˆSchedulerï¼‰**ï¼šä»»åŠ¡è°ƒåº¦å’Œæ‰¹å¤„ç†

è¯¦ç»†æ–‡æ¡£è¯·å‚è€ƒ[SDKæ–‡æ¡£](/packages/trace-sdk/README.md)ã€‚

### åç«¯æœåŠ¡

TraceFlow Serveræ˜¯åŸºäºNestJSæ„å»ºçš„åç«¯æœåŠ¡ï¼Œè´Ÿè´£æ•°æ®é‡‡é›†ã€å¤„ç†å’Œå­˜å‚¨ï¼š

- é«˜æ€§èƒ½æ•°æ®æ¥æ”¶API
- å®æ—¶æ•°æ®å¤„ç†ç®¡é“
- æ•°æ®èšåˆå’Œåˆ†ææœåŠ¡
- å‘Šè­¦å’Œé€šçŸ¥ç³»ç»Ÿ

è¯¦ç»†æ–‡æ¡£è¯·å‚è€ƒ[Serveræ–‡æ¡£](/packages/trace-server/README.md)ã€‚

### ç®¡ç†å¹³å°

TraceFlow Adminæ˜¯ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„ç›‘æ§ç®¡ç†å¹³å°ï¼š

- å®æ—¶ç›‘æ§ä»ªè¡¨æ¿
- æ€§èƒ½åˆ†ææŠ¥è¡¨
- ç”¨æˆ·è¡Œä¸ºåˆ†æ
- é”™è¯¯è¯Šæ–­å’Œé—®é¢˜æ’æŸ¥
- è‡ªå®šä¹‰å‘Šè­¦é…ç½®

## ä»£ç è§„èŒƒ

æœ¬é¡¹ç›®ä½¿ç”¨ ESLint å’Œ Prettier è¿›è¡Œä»£ç è§„èŒƒå’Œæ ¼å¼åŒ–ï¼š

```bash
# è¿è¡Œä»£ç æ£€æŸ¥
pnpm lint

# ä¿®å¤ä»£ç è§„èŒƒé—®é¢˜
pnpm lint:fix

# æ ¼å¼åŒ–ä»£ç 
pnpm format
```

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestã€‚åœ¨æäº¤ PR ä¹‹å‰ï¼Œè¯·ç¡®ä¿ï¼š

1. ä»£ç é€šè¿‡æ‰€æœ‰ ESLint æ£€æŸ¥
2. æ‰€æœ‰æ–°åŠŸèƒ½éƒ½æœ‰ç›¸åº”çš„æµ‹è¯•
3. æ›´æ–°ç›¸å…³æ–‡æ¡£

## License

ISC License
